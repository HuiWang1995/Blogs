# 微服务网关BUG三种



网关的BUG表现往往是这样的: 我们前端访问后端微服务,或者微服务之间调用.采用直连时(即直接IP或者域名),是可以访问通的. 但是配置成网关后,则无法访问成功. 这样的问题,往往需要寻找网关负责人尽快介入排查问题.以下我遇到三种情况,提供解决思路,但是不同的网关不一定适用.



## BUG 1

情况: 前端某个页面访问后端404, 但是其他页面正常.

找网关介入后得知,网关日志中打印出其转发到另一个网关的URL不是预期的URL.经检查发现人为配置网关接口时配置错误,有多余前缀.

这种情况有网关的介入可以看到真实请求的URL,可以更好更直观的定位.



## BUG 2

情况: 后端接收到了请求,但是ERROR日志说,该请求没有请求体. 然前端送了请求体.

找网关介入后发现,该网关的DELETE请求会将报文体过滤掉,不进行转发.

这种情况要不网关改,要不应用改.在网关不给力或者规则限制下,我们只能将DELETE改成POST,并修改了前后端的URL解决.



## BUG 3

情况:某个接口网关返回超时异常.后端没有接收到请求.

找网关介入后,询问响应吗具体信息,是没有找到后端服务实例.通过检查注册中心否决其说法.通过浏览器右击请求copy as curl,并对比正常的接口请求.最后得出该请求因为没有body,导致网关找不到微服务. (PS: 这是一种实际情况,我对其的理解是一种网关的BUG,因为这个接口我们的确不需要body).

这种情况我们通过添加空报文体进行解决.



## 总结

网关BUG千万种,前端后端都无过,只因经过中间人,迅速定位把人找.

